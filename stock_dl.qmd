---
jupyter:
  jupytext:
    text_representation:
      extension: .qmd
      format_name: quarto
      format_version: "1.0"
      jupytext_version: 1.18.1
  kernelspec:
    display_name: Python 3
    language: python
    name: python3
---

```{python}
import yfinance as yf
import pandas as pd

# from datetime import datetime, date

# _today = date.today().strftime("%Y-%m-%d")
# print(f"today is '{_today}'")
```

```{python}
symbols = [
    # "MSFT",
    "AAPL",
    "AMD",
    # "GOOG",
    # "AMZN",
    "UPST",
    "TTD",
    "OXY",
    # "^VIX",
    "QQQ",
    "SPY",
]
data = yf.download(symbols, start="2023-01-01", end="2023-07-31")
print(data.head())
```

```{python}
# format the columns
colnames = data.columns
indexes = data.index

print(colnames)
print(indexes)
```

```{python}
# Split the data by type of prices, adj close, open, etc
adj_close_df = data["Adj Close"]
close_df = data["Close"]
high_df = data["High"]
low_df = data["Low"]
open_df = data["Open"]
volume_df = data["Volume"]

price_type = [adj_close_df, close_df, high_df, low_df, open_df, volume_df]
```

```{python}
for df in price_type:
    print(f"Adjust close: {adj_close_df.round(2)}")
    print(f"Close: {close_df.round(2)}")
    print(f"High: {high_df.round(2)}")
    print(f"Low: {low_df.round(2)}")
    print(f"Open: {open_df.round(2)}")
    print(f"Close: {close_df.round(2)}")
# df
```

```{python}
# split based on symbol:
data.columns = data.columns.swaplevel(0, 1)
data.sort_index(axis=1, level=0, inplace=True)

# print(data)

data_dfs = {}

for symbol in symbols:
    data_dfs[symbol] = data[symbol].copy()
    data_dfs[symbol]["Volume"] /= 1_000_000
    data_dfs[symbol] = data_dfs[symbol].round(0)


for symbol, df in data.items():
    print(f"Data for symbol: {symbol}")
    print(df)
```

